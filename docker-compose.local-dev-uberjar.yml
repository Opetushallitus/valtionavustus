name: valtionavustus-local
services:
  va:
    build:
      context: .
      target: va-server
      args:
        - NODE_VERSION
    environment:
      - PAYMENT_SERVICE_HOST=maksatuspalvelu
      - PAYMENT_SERVICE_HOST_KEY=ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDummyKeyForLocalDev
      - config=/app/server/config/local.edn
      - configdefaults=/app/server/config/defaults.edn
    ports:
      - '127.0.0.1:8080:8080'
      - '127.0.0.1:8081:8081'
      - '127.0.0.1:7999:7999'

  db:
    ports:
      - '127.0.0.1:42042:5432'

  fakesmtp:
    ports:
      - '127.0.0.1:42069:25'

  pagerduty:
    ports:
      - '127.0.0.1:8888:8080'

  maksatuspalvelu:
    ports:
      - '127.0.0.1:42022:22'

networks:
  default:
    name: valtionavustus_local-dev
